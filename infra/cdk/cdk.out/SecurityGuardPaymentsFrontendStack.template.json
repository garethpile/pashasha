{
  "Resources": {
    "AmplifyAppRole0364E92A": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "amplify.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "SecurityGuardPaymentsFrontendStack/AmplifyApp/Role/Resource"
      }
    },
    "AmplifyApp6046A70F": {
      "Type": "AWS::Amplify::App",
      "Properties": {
        "BasicAuthConfig": {
          "EnableBasicAuth": false
        },
        "BuildSpec": "{\n  \"version\": \"1.0\",\n  \"applications\": [\n    {\n      \"appRoot\": \".\",\n      \"frontend\": {\n        \"phases\": {\n          \"preBuild\": {\n            \"commands\": [\n              \"npm install\"\n            ]\n          },\n          \"build\": {\n            \"commands\": [\n              \"npm run build --workspace frontend\"\n            ]\n          }\n        },\n        \"artifacts\": {\n          \"baseDirectory\": \"apps/frontend/out\",\n          \"files\": [\n            \"**/*\"\n          ]\n        },\n        \"cache\": {\n          \"paths\": [\n            \"node_modules/**/*\",\n            \"apps/frontend/node_modules/**/*\"\n          ]\n        }\n      },\n      \"customRules\": [\n        {\n          \"source\": \"/<*>\",\n          \"target\": \"/index.html\",\n          \"status\": \"200\"\n        }\n      ]\n    }\n  ]\n}",
        "Description": "Amplify hosted Next.js frontend for the Security Guard tip platform.",
        "EnableBranchAutoDeletion": true,
        "EnvironmentVariables": [
          {
            "Name": "NEXT_PUBLIC_API_BASE_URL",
            "Value": {
              "Fn::Join": [
                "",
                [
                  "https://",
                  {
                    "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputFnGetAttBackendDistribution025C1152DomainNameAA03E149"
                  },
                  "/api/guards"
                ]
              ]
            }
          },
          {
            "Name": "NEXT_PUBLIC_BACKEND_API_ROOT",
            "Value": {
              "Fn::Join": [
                "",
                [
                  "https://",
                  {
                    "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputFnGetAttBackendDistribution025C1152DomainNameAA03E149"
                  },
                  "/api"
                ]
              ]
            }
          },
          {
            "Name": "NEXT_PUBLIC_LEGACY_BACKEND_BASE",
            "Value": {
              "Fn::Join": [
                "",
                [
                  "http://",
                  {
                    "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputFnGetAttBackendFargateServiceLBA38260FEDNSNameC594C614"
                  }
                ]
              ]
            }
          },
          {
            "Name": "NEXT_PUBLIC_COGNITO_USER_POOL_ID",
            "Value": {
              "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputRefUserPool6BA7E5F296FD7236"
            }
          },
          {
            "Name": "NEXT_PUBLIC_COGNITO_CLIENT_ID",
            "Value": {
              "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputRefUserPoolWebClient4C9370B02E2C9FF9"
            }
          },
          {
            "Name": "NEXT_PUBLIC_AWS_REGION",
            "Value": "eu-west-1"
          }
        ],
        "IAMServiceRole": {
          "Fn::GetAtt": ["AmplifyAppRole0364E92A", "Arn"]
        },
        "Name": "security-guard-payments-frontend",
        "Platform": "WEB"
      },
      "Metadata": {
        "aws:cdk:path": "SecurityGuardPaymentsFrontendStack/AmplifyApp/Resource"
      }
    },
    "AmplifyAppPrimaryBranch02455E21": {
      "Type": "AWS::Amplify::Branch",
      "Properties": {
        "AppId": {
          "Fn::GetAtt": ["AmplifyApp6046A70F", "AppId"]
        },
        "BranchName": "main",
        "EnableAutoBuild": false,
        "EnablePullRequestPreview": false,
        "EnvironmentVariables": [
          {
            "Name": "NEXT_PUBLIC_API_BASE_URL",
            "Value": {
              "Fn::Join": [
                "",
                [
                  "https://",
                  {
                    "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputFnGetAttBackendDistribution025C1152DomainNameAA03E149"
                  },
                  "/api/guards"
                ]
              ]
            }
          },
          {
            "Name": "NEXT_PUBLIC_BACKEND_API_ROOT",
            "Value": {
              "Fn::Join": [
                "",
                [
                  "https://",
                  {
                    "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputFnGetAttBackendDistribution025C1152DomainNameAA03E149"
                  },
                  "/api"
                ]
              ]
            }
          },
          {
            "Name": "NEXT_PUBLIC_LEGACY_BACKEND_BASE",
            "Value": {
              "Fn::Join": [
                "",
                [
                  "http://",
                  {
                    "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputFnGetAttBackendFargateServiceLBA38260FEDNSNameC594C614"
                  }
                ]
              ]
            }
          },
          {
            "Name": "NEXT_PUBLIC_COGNITO_USER_POOL_ID",
            "Value": {
              "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputRefUserPool6BA7E5F296FD7236"
            }
          },
          {
            "Name": "NEXT_PUBLIC_COGNITO_CLIENT_ID",
            "Value": {
              "Fn::ImportValue": "SecurityGuardPaymentsBackendStack:ExportsOutputRefUserPoolWebClient4C9370B02E2C9FF9"
            }
          },
          {
            "Name": "NEXT_PUBLIC_AWS_REGION",
            "Value": "eu-west-1"
          }
        ],
        "Stage": "PRODUCTION"
      },
      "Metadata": {
        "aws:cdk:path": "SecurityGuardPaymentsFrontendStack/AmplifyApp/PrimaryBranch/Resource"
      }
    },
    "AmplifyAppCustomDomain520C9CD9": {
      "Type": "AWS::Amplify::Domain",
      "Properties": {
        "AppId": {
          "Fn::GetAtt": ["AmplifyApp6046A70F", "AppId"]
        },
        "AutoSubDomainCreationPatterns": ["*", "pr*"],
        "AutoSubDomainIAMRole": {
          "Fn::GetAtt": ["AmplifyAppRole0364E92A", "Arn"]
        },
        "DomainName": "pashasha.com",
        "EnableAutoSubDomain": true,
        "SubDomainSettings": [
          {
            "BranchName": {
              "Fn::GetAtt": ["AmplifyAppPrimaryBranch02455E21", "BranchName"]
            },
            "Prefix": "www"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "SecurityGuardPaymentsFrontendStack/AmplifyApp/CustomDomain/Resource"
      }
    },
    "CDKMetadata": {
      "Type": "AWS::CDK::Metadata",
      "Properties": {
        "Analytics": "v2:deflate64:H4sIAAAAAAAA/z2NywrCMBBFv6X7ZFqLgktfe6F+gIxpSlPzokkUCfl3mxpc3eFc7pkWNrs9xKbCt6Osf1IpHhBvHtmTLOgeBSqInZGcnAedMxFUVorhA3EhR2tzcZpRszFfF6NQ6JRIx50JM1t31+Bt8Kuh0EQaitKOCE11KL/rnEVeypj9Rf43a9NzmFz9arfQLvvJCUHnoL1QHLpffgGcHvMo2AAAAA=="
      },
      "Metadata": {
        "aws:cdk:path": "SecurityGuardPaymentsFrontendStack/CDKMetadata/Default"
      }
    }
  },
  "Outputs": {
    "AmplifyAppId": {
      "Value": {
        "Fn::GetAtt": ["AmplifyApp6046A70F", "AppId"]
      }
    },
    "AmplifyDefaultDomain": {
      "Value": {
        "Fn::Join": [
          "",
          [
            "https://",
            {
              "Fn::GetAtt": ["AmplifyAppPrimaryBranch02455E21", "BranchName"]
            },
            ".",
            {
              "Fn::GetAtt": ["AmplifyApp6046A70F", "DefaultDomain"]
            }
          ]
        ]
      }
    },
    "AmplifyCustomDomain": {
      "Value": "https://www.pashasha.com"
    }
  },
  "Parameters": {
    "BootstrapVersion": {
      "Type": "AWS::SSM::Parameter::Value<String>",
      "Default": "/cdk-bootstrap/hnb659fds/version",
      "Description": "Version of the CDK Bootstrap resources in this environment, automatically retrieved from SSM Parameter Store. [cdk:skip]"
    }
  },
  "Rules": {
    "CheckBootstrapVersion": {
      "Assertions": [
        {
          "Assert": {
            "Fn::Not": [
              {
                "Fn::Contains": [
                  ["1", "2", "3", "4", "5"],
                  {
                    "Ref": "BootstrapVersion"
                  }
                ]
              }
            ]
          },
          "AssertDescription": "CDK bootstrap stack version 6 required. Please run 'cdk bootstrap' with a recent version of the CDK CLI."
        }
      ]
    }
  }
}
